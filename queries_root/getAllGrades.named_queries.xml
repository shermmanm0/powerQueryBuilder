<queries>
	<query name = "com.cristoreyrichmond.powerschool.assignment_grades.data_puller" coreTable = "" flattened = "false">
		<description>pulls all student grades</description>
		<args>
		</args>
		<columns>
			<column column="ASSIGNMENT.ASSIGNMENTID">assignment.assignmentid</column>
			<column column="ASSIGNMENTSCORE.SCOREPERCENT">assignmentscore.scorepercent</column>
			<column column="ASSIGNMENTSECTION.NAME">assignmentsection.name</column>
			<column column="SECTIONS.EXTERNAL_EXPRESSION">sections.external_expression</column>
			<column column="STUDENTS.ID">students.id</column>
			<column column="TEACHERCATEGORY.NAME">teachercategory.name</column>
			<column column="TERMBINS.STORECODE">termbins.storecode</column>
			<column column="U_DEF_EXT_STUDENTS.WORKSTUDYDAY">u_def_ext_students.workstudyday</column>
			<column column="USERS.LAST_NAME">users.last_name</column>
		</columns>
		<sql>
			<![CDATA[
			select ascore.scorepercent, s.id, asec.name, sec.external_expression,a.assignmentid, udef.workstudyday, tb.storecode, tc.name, u.last_name
from assignmentscore ascore
inner join students s on ascore.studentsdcid = s.dcid
inner join assignmentsection asec on ascore.assignmentsectionid = asec.assignmentsectionid
inner join sections sec on asec.sectionsdcid = sec.dcid
inner join assignment a on asec.assignmentid = a.assignmentid
inner join u_def_ext_students udef on s.dcid = udef.studentsdcid
inner join termbins tb on asec.duedate > tb.date1 and asec.duedate < tb.date2
inner join AssignmentCategoryAssoc aca on asec.assignmentsectionid = aca.assignmentsectionid
inner join teachercategory tc on aca.teachercategoryid = tc.teachercategoryid
inner join users u on sec.teacher = u.dcid
where tb.storecode like 'Q%' and s.enroll_status = 0]]>
		</sql>
	</query>
</queries>